<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calculator Example</title>
    <link rel="stylesheet" href="/styles/style.css" />
  </head>
  <body>
    <h1>Calculator</h1>

    <!-- Input fields for num1 and num2 -->
    <div>
      <label for="num1">Num1:</label>
      <input type="number" id="num1" name="num1" />
    </div>

    <div>
      <label for="num2">Num2:</label>
      <input type="number" id="num2" name="num2" />
    </div>

    <!-- Add button to trigger calculation -->
    <button id="addButton">Add</button>

    <div>
      <h2>Result: <span id="result">0</span></h2>
    </div>

    <div id="loading">Loading...</div>
    <!-- Loading indicator -->

    <script>
      // Get the button and result elements
      const addButton = document.getElementById("addButton");
      const resultElement = document.getElementById("result");
      const loadingIndicator = document.getElementById("loading");

      // Add an event listener to the 'Add' button
      addButton.addEventListener("click", function () {
        // Get the values from the input fields
        const num1 = parseFloat(document.getElementById("num1").value);
        const num2 = parseFloat(document.getElementById("num2").value);

        // Check if the inputs are valid numbers
        if (isNaN(num1) || isNaN(num2)) {
          resultElement.innerHTML = "Please enter valid numbers.";
          return;
        }

        // Show loading indicator while fetching data
        loadingIndicator.style.display = "block";
        resultElement.innerHTML = ""; // Clear previous result

        // Fetch the result from the server
        fetch(`/calculator/add?num1=${num1}&num2=${num2}`)
          .then((response) => {
            if (!response.ok) {
              // Handle non-200 HTTP responses
              throw new Error("Server error");
            }
            return response.json();
          })
          .then((data) => {
            // Display the result
            resultElement.innerHTML = data.result;
          })
          .catch((error) => {
            resultElement.innerHTML = "Error: Unable to fetch result.";
          })
          .finally(() => {
            // Hide loading indicator after the request is finished
            loadingIndicator.style.display = "none";
          });
      });
    </script>
  </body>
</html>
